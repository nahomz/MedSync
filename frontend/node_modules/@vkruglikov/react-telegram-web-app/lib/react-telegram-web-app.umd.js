!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((n||self).reactTelegramWebApp={},n.react)}(this,function(n,e){function t(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var u,o=/*#__PURE__*/t(e),l="undefined"!=typeof window&&null!=(u=window)&&null!=(u=u.Telegram)&&u.WebApp?window.Telegram.WebApp:null,r=e.createContext(l),i={smoothButtonsTransition:!1,smoothButtonsTransitionMs:10},c=e.createContext(i),a=function(){return{MainButton:{current:null},BackButton:{current:null}}},s=e.createContext({MainButton:{current:null},BackButton:{current:null}}),f=function(){},d=function(n){var t=n.id,u=n.show,o=void 0===u?f:u,l=n.hide,r=void 0===l?f:l,i=n.currentShowedIdRef,a=e.useContext(c),s=a.smoothButtonsTransition,d=a.smoothButtonsTransitionMs;e.useEffect(function(){return o(),i.current=t,function(){s?(i.current=null,setTimeout(function(){i.current||r()},d)):(r(),i.current=null)}},[r,t,i,o,s,d])},v=function(){return e.useContext(r)};function p(){return p=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(n[u]=t[u])}return n},p.apply(this,arguments)}n.BackButton=function(n){var t=n.onClick,u=e.useContext(s),o=e.useId(),l=v(),r=null==l?void 0:l.BackButton;return e.useEffect(function(){if(t&&r)return r.onClick(t),function(){r.offClick(t)}},[t,r]),d({show:null==r?void 0:r.show,hide:null==r?void 0:r.hide,currentShowedIdRef:u.BackButton,id:o}),null},n.MainButton=function(n){var t=n.text,u=void 0===t?"CONTINUE":t,o=n.progress,l=void 0!==o&&o,r=n.disable,i=n.disabled,c=void 0!==i&&i,a=n.color,f=n.textColor,p=n.onClick,m=e.useContext(s),h=e.useId(),b=v(),C=null==b?void 0:b.MainButton,w=null==b?void 0:b.themeParams,k=r||c;return e.useEffect(function(){null==C||C.setParams({color:a||(null==w?void 0:w.button_color)||"#fff"})},[a,w,C]),e.useEffect(function(){null==C||C.setParams({text_color:f||(null==w?void 0:w.button_text_color)||"#000"})},[C,w,f]),e.useEffect(function(){null==C||C.setText(u)},[u,C]),e.useEffect(function(){k?null==C||C.disable():k||null==C||C.enable()},[k,C]),e.useEffect(function(){l?null==C||C.showProgress(!1):l||null==C||C.hideProgress()},[l,C]),e.useEffect(function(){if(p)return null==C||C.onClick(p),function(){null==C||C.offClick(p)}},[p,C]),d({show:null==C?void 0:C.show,hide:null==C?void 0:C.hide,currentShowedIdRef:m.MainButton,id:h}),null},n.WebAppProvider=function(n){var t=n.children,u=n.options,f=e.useMemo(function(){return p({},i,u)},[u]),d=e.useMemo(a,[]);return e.useEffect(function(){if(null!=u&&u.smoothButtonsTransition){var n=function(){var n,e;null==l||null==(n=l.MainButton)||n.hide(),null==l||null==(e=l.BackButton)||e.hide()};return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}},[null==u?void 0:u.smoothButtonsTransition]),o.default.createElement(s.Provider,{value:d},o.default.createElement(r.Provider,{value:l},o.default.createElement(c.Provider,{value:f},t)))},n.useCloudStorage=function(){var n,t=null==(n=v())?void 0:n.CloudStorage,u=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.getItem(n,function(n,t){n?u(n):e(t)})})},[t]),o=e.useCallback(function(n,e){return new Promise(function(u,o){null==t||t.setItem(n,e,function(n,e){!n&&e?u():o(n)})})},[t]),l=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.getItems(n,function(n,t){!n&&t?e(t):u(n)})})},[t]),r=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.removeItem(n,function(n,t){!n&&t?e():u(n)})})},[t]),i=e.useCallback(function(n){return new Promise(function(e,u){null==t||t.removeItems(n,function(n,t){!n&&t?e():u(n)})})},[t]),c=e.useCallback(function(){return new Promise(function(n,e){null==t||t.getKeys(function(t,u){!t&&u?n(u):e(t)})})},[t]);return e.useMemo(function(){return{getItem:u,setItem:o,getItems:l,removeItem:r,removeItems:i,getKeys:c}},[t])},n.useExpand=function(){var n=v(),t=e.useState(null==n?void 0:n.isExpanded),u=t[0],o=t[1];return e.useEffect(function(){if(n){var e=function(e){e.isStateStable&&o(n.isExpanded)};return n.onEvent("viewportChanged",e),function(){return n.offEvent("viewportChanged",e)}}},[n]),[u,e.useCallback(function(){return null==n||null==n.expand?void 0:n.expand()},[n])]},n.useHapticFeedback=function(){var n=v(),t=null==n?void 0:n.HapticFeedback,u=e.useCallback(function(){return null==t?void 0:t.impactOccurred.apply(t,[].slice.call(arguments))},[t]),o=e.useCallback(function(){return null==t?void 0:t.notificationOccurred.apply(t,[].slice.call(arguments))},[t]),l=e.useCallback(function(){return null==t?void 0:t.selectionChanged.apply(t,[].slice.call(arguments))},[t]);return[u,o,l]},n.useInitData=function(){var n=v();return[n.initDataUnsafe,n.initData]},n.useReadTextFromClipboard=function(){var n=v();return e.useCallback(function(){return new Promise(function(e){null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(e)})},[n])},n.useScanQrPopup=function(){var n=v(),t=e.useCallback(function(){return null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup.apply(n,[].slice.call(arguments))},[n]);return[t,e.useCallback(function(){return null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup()},[n])]},n.useShowPopup=function(){var n=v();return e.useCallback(function(e){return new Promise(function(t,u){try{null==n||null==n.showPopup||n.showPopup(e,function(n){t(n)})}catch(n){u(n)}})},[n])},n.useSwitchInlineQuery=function(){var n=v();return e.useCallback(function(){return null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery.apply(n,[].slice.call(arguments))},[n])},n.useThemeParams=function(){var n=v(),t=e.useState(null==n?void 0:n.colorScheme),u=t[0],o=t[1],l=e.useState((null==n?void 0:n.themeParams)||{}),r=l[0],i=l[1];return e.useEffect(function(){if(n){var e=function(){o(n.colorScheme),i(n.themeParams)};return n.onEvent("themeChanged",e),function(){n.offEvent("themeChanged",e)}}},[n]),[u,r]},n.useWebApp=function(){return v()}});
