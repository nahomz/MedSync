import n,{createContext as t,useContext as o,useEffect as e,useId as u,useCallback as r,useState as i,useMemo as l}from"react";var c,a="undefined"!=typeof window&&null!=(c=window)&&null!=(c=c.Telegram)&&c.WebApp?window.Telegram.WebApp:null,f=t(a),s={smoothButtonsTransition:!1,smoothButtonsTransitionMs:10},d=t(s),v=function(){return{MainButton:{current:null},BackButton:{current:null}}},m=t({MainButton:{current:null},BackButton:{current:null}}),h=function(){},p=function(n){var t=n.id,u=n.show,r=void 0===u?h:u,i=n.hide,l=void 0===i?h:i,c=n.currentShowedIdRef,a=o(d),f=a.smoothButtonsTransition,s=a.smoothButtonsTransitionMs;e(function(){return r(),c.current=t,function(){f?(c.current=null,setTimeout(function(){c.current||l()},s)):(l(),c.current=null)}},[l,t,c,r,f,s])},w=function(){return o(f)},P=function(n){var t=n.text,r=void 0===t?"CONTINUE":t,i=n.progress,l=void 0!==i&&i,c=n.disable,a=n.disabled,f=void 0!==a&&a,s=n.color,d=n.textColor,v=n.onClick,h=o(m),P=u(),B=w(),g=null==B?void 0:B.MainButton,b=null==B?void 0:B.themeParams,C=c||f;return e(function(){null==g||g.setParams({color:s||(null==b?void 0:b.button_color)||"#fff"})},[s,b,g]),e(function(){null==g||g.setParams({text_color:d||(null==b?void 0:b.button_text_color)||"#000"})},[g,b,d]),e(function(){null==g||g.setText(r)},[r,g]),e(function(){C?null==g||g.disable():C||null==g||g.enable()},[C,g]),e(function(){l?null==g||g.showProgress(!1):l||null==g||g.hideProgress()},[l,g]),e(function(){if(v)return null==g||g.onClick(v),function(){null==g||g.offClick(v)}},[v,g]),p({show:null==g?void 0:g.show,hide:null==g?void 0:g.hide,currentShowedIdRef:h.MainButton,id:P}),null},B=function(n){var t=n.onClick,r=o(m),i=u(),l=w(),c=null==l?void 0:l.BackButton;return e(function(){if(t&&c)return c.onClick(t),function(){c.offClick(t)}},[t,c]),p({show:null==c?void 0:c.show,hide:null==c?void 0:c.hide,currentShowedIdRef:r.BackButton,id:i}),null},g=function(){var n=w();return r(function(t){return new Promise(function(o,e){try{null==n||null==n.showPopup||n.showPopup(t,function(n){o(n)})}catch(n){e(n)}})},[n])},b=function(){var n=w(),t=null==n?void 0:n.HapticFeedback,o=r(function(){return null==t?void 0:t.impactOccurred.apply(t,[].slice.call(arguments))},[t]),e=r(function(){return null==t?void 0:t.notificationOccurred.apply(t,[].slice.call(arguments))},[t]),u=r(function(){return null==t?void 0:t.selectionChanged.apply(t,[].slice.call(arguments))},[t]);return[o,e,u]},C=function(){var n=w(),t=i(null==n?void 0:n.colorScheme),o=t[0],u=t[1],r=i((null==n?void 0:n.themeParams)||{}),l=r[0],c=r[1];return e(function(){if(n){var t=function(){u(n.colorScheme),c(n.themeParams)};return n.onEvent("themeChanged",t),function(){n.offEvent("themeChanged",t)}}},[n]),[o,l]},I=function(){var n=w(),t=r(function(){return null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup.apply(n,[].slice.call(arguments))},[n]);return[t,r(function(){return null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup()},[n])]},y=function(){var n=w();return r(function(){return new Promise(function(t){null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(t)})},[n])},T=function(){var n=w();return r(function(){return null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery.apply(n,[].slice.call(arguments))},[n])},k=function(){var n=w(),t=i(null==n?void 0:n.isExpanded),o=t[0],u=t[1];return e(function(){if(n){var t=function(t){t.isStateStable&&u(n.isExpanded)};return n.onEvent("viewportChanged",t),function(){return n.offEvent("viewportChanged",t)}}},[n]),[o,r(function(){return null==n||null==n.expand?void 0:n.expand()},[n])]},x=function(){var n,t=null==(n=w())?void 0:n.CloudStorage,o=r(function(n){return new Promise(function(o,e){null==t||t.getItem(n,function(n,t){n?e(n):o(t)})})},[t]),e=r(function(n,o){return new Promise(function(e,u){null==t||t.setItem(n,o,function(n,t){!n&&t?e():u(n)})})},[t]),u=r(function(n){return new Promise(function(o,e){null==t||t.getItems(n,function(n,t){!n&&t?o(t):e(n)})})},[t]),i=r(function(n){return new Promise(function(o,e){null==t||t.removeItem(n,function(n,t){!n&&t?o():e(n)})})},[t]),c=r(function(n){return new Promise(function(o,e){null==t||t.removeItems(n,function(n,t){!n&&t?o():e(n)})})},[t]),a=r(function(){return new Promise(function(n,o){null==t||t.getKeys(function(t,e){!t&&e?n(e):o(t)})})},[t]);return l(function(){return{getItem:o,setItem:e,getItems:u,removeItem:i,removeItems:c,getKeys:a}},[t])};function E(){return E=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(n[e]=o[e])}return n},E.apply(this,arguments)}var S=function(t){var o=t.children,u=t.options,r=l(function(){return E({},s,u)},[u]),i=l(v,[]);return e(function(){if(null!=u&&u.smoothButtonsTransition){var n=function(){var n,t;null==a||null==(n=a.MainButton)||n.hide(),null==a||null==(t=a.BackButton)||t.hide()};return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}},[null==u?void 0:u.smoothButtonsTransition]),n.createElement(m.Provider,{value:i},n.createElement(f.Provider,{value:a},n.createElement(d.Provider,{value:r},o)))},M=function(){var n=w();return[n.initDataUnsafe,n.initData]},O=function(){return w()};export{B as BackButton,P as MainButton,S as WebAppProvider,x as useCloudStorage,k as useExpand,b as useHapticFeedback,M as useInitData,y as useReadTextFromClipboard,I as useScanQrPopup,g as useShowPopup,T as useSwitchInlineQuery,C as useThemeParams,O as useWebApp};
